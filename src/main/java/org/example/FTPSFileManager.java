package org.example;

import org.apache.commons.net.ftp.*;

import javax.swing.*;
import javax.swing.tree.DefaultMutableTreeNode;
import javax.swing.tree.DefaultTreeModel;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.*;
import java.util.Arrays;
import javax.net.ssl.SSLContext;
import javax.net.ssl.TrustManager;

/**
 * üîí FTPS File Manager - Main GUI Application
 * 
 * ·ª®ng d·ª•ng Java Swing demo s·ª± kh√°c bi·ªát b·∫£o m·∫≠t gi·ªØa Plain FTP v√† FTPS.
 * 
 * T√çNH NƒÇNG CH√çNH:
 * ‚Ä¢ K·∫øt n·ªëi FTP/FTPS v·ªõi visual security indicators
 * ‚Ä¢ Upload/Download files v·ªõi real-time progress
 * ‚Ä¢ Browse remote directory structure
 * ‚Ä¢ FTP command logging v√† TLS handshake monitoring
 * ‚Ä¢ Custom certificate support cho server validation
 * 
 * B·∫¢O M·∫¨T DEMO:
 * ‚Ä¢ Plain FTP: ‚ö†Ô∏è Username, password, files truy·ªÅn d·∫°ng plain text
 * ‚Ä¢ FTPS: üîí To√†n b·ªô d·ªØ li·ªáu ƒë∆∞·ª£c m√£ h√≥a TLS 1.2
 * 
 * FTP COMMANDS DEMO:
 * ‚Ä¢ AUTH TLS: Kh·ªüi t·∫°o TLS handshake
 * ‚Ä¢ PBSZ 0: Thi·∫øt l·∫≠p secure data channel
 * ‚Ä¢ PROT P: B·∫≠t data encryption
 * ‚Ä¢ PASV: Passive mode cho firewall compatibility
 * ‚Ä¢ LIST/STOR/RETR: File operations v·ªõi encryption status
 * 
 * GUI COMPONENTS:
 * ‚Ä¢ Connection Panel: Host, credentials, TLS toggle, certificate
 * ‚Ä¢ File Tree: Remote directory browser
 * ‚Ä¢ Log Panel: Real-time FTP command monitoring
 * ‚Ä¢ Status Panel: Security status indicators
 * 
 * @author Demo Application
 * @version 1.0
 * @see CertificateManager SSL certificate handling
 */
public class FTPSFileManager extends JFrame {
    // === FTP CLIENT ===
    /** FTP/FTPS client instance - switches between FTPClient (plain) and FTPSClient (secure) */
    private FTPClient ftpClient;
    
    // === GUI COMPONENTS - CONNECTION PANEL ===
    /** Server hostname/IP input field */
    private JTextField hostField, portField, usernameField, certPathField;
    /** Password input field (masked) */
    private JPasswordField passwordField;
    /** TLS enable/disable checkbox - key security toggle */
    private JCheckBox tlsCheckBox;
    /** Connection control buttons */
    private JButton connectButton, disconnectButton, browseCertButton;
    
    // === GUI COMPONENTS - FILE OPERATIONS ===
    /** Remote directory tree display */
    private JTree fileTree;
    /** Tree model for dynamic file list updates */
    private DefaultTreeModel treeModel;
    /** File operation buttons */
    private JButton uploadButton, downloadButton;
    
    // === GUI COMPONENTS - MONITORING ===
    /** FTP command log display area */
    private JTextArea logArea;
    /** Security status indicator (Green=Secure, Red=Insecure) */
    private JLabel statusLabel;
    
    /**
     * Constructor - kh·ªüi t·∫°o FTPS File Manager GUI
     * T·∫°o giao di·ªán v√† FTP client m·∫∑c ƒë·ªãnh (plain FTP)
     */
    public FTPSFileManager() {
        initializeGUI();
        ftpClient = new FTPClient();
    }
    
    /**
     * Kh·ªüi t·∫°o giao di·ªán ng∆∞·ªùi d√πng v·ªõi layout ch√≠nh:
     * - NORTH: Connection panel (host, credentials, TLS toggle)
     * - CENTER: Split pane (file tree + command log)
     * - SOUTH: Status panel (security indicators)
     */
    private void initializeGUI() {
        setTitle("FTPS File Manager");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout());
        
        // Connection Panel
        JPanel connectionPanel = createConnectionPanel();
        add(connectionPanel, BorderLayout.NORTH);
        
        // Main Panel
        JSplitPane mainSplit = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT);
        
        // File Tree Panel
        JPanel treePanel = createTreePanel();
        mainSplit.setLeftComponent(treePanel);
        
        // Log Panel
        JPanel logPanel = createLogPanel();
        mainSplit.setRightComponent(logPanel);
        
        mainSplit.setDividerLocation(400);
        add(mainSplit, BorderLayout.CENTER);
        
        // Status Panel
        JPanel statusPanel = createStatusPanel();
        add(statusPanel, BorderLayout.SOUTH);
        
        setSize(800, 600);
        setLocationRelativeTo(null);
    }
    
    /**
     * T·∫°o connection panel v·ªõi:
     * - Row 1: Host, Username, Password fields
     * - Row 2: TLS checkbox, Certificate path, Browse button
     * - Row 3: Connect/Disconnect buttons
     * 
     * @return JPanel ch·ª©a t·∫•t c·∫£ connection controls
     */
    private JPanel createConnectionPanel() {
        JPanel panel = new JPanel(new GridBagLayout());
        GridBagConstraints gbc = new GridBagConstraints();
        
        gbc.insets = new Insets(8, 8, 8, 8);
        gbc.fill = GridBagConstraints.HORIZONTAL;
        
        // Row 1: Host, Port, Username, Password
        gbc.gridx = 0; gbc.gridy = 0; gbc.weightx = 0;
        panel.add(new JLabel("Host:"), gbc);
        gbc.gridx = 1; gbc.weightx = 1;
        hostField = new JTextField("localhost");
        hostField.setPreferredSize(new Dimension(120, 25));
        panel.add(hostField, gbc);
        
        gbc.gridx = 2; gbc.weightx = 0;
        panel.add(new JLabel("Port:"), gbc);
        gbc.gridx = 3; gbc.weightx = 0;
        portField = new JTextField("21");
        portField.setPreferredSize(new Dimension(60, 25));
        panel.add(portField, gbc);
        
        gbc.gridx = 4; gbc.weightx = 0;
        panel.add(new JLabel("Username:"), gbc);
        gbc.gridx = 5; gbc.weightx = 1;
        usernameField = new JTextField("demo");
        usernameField.setPreferredSize(new Dimension(100, 25));
        panel.add(usernameField, gbc);
        
        gbc.gridx = 6; gbc.weightx = 0;
        panel.add(new JLabel("Password:"), gbc);
        gbc.gridx = 7; gbc.weightx = 1;
        passwordField = new JPasswordField("demo123");
        passwordField.setPreferredSize(new Dimension(100, 25));
        panel.add(passwordField, gbc);
        
        // Row 2: TLS, Certificate, Buttons
        gbc.gridx = 0; gbc.gridy = 1; gbc.weightx = 0;
        tlsCheckBox = new JCheckBox("üîí Enable TLS (Secure)", false);
        // Auto-update port when TLS checkbox changes
        tlsCheckBox.addActionListener(e -> {
            portField.setText(tlsCheckBox.isSelected() ? "990" : "21");
        });
        panel.add(tlsCheckBox, gbc);
        
        gbc.gridx = 1; gbc.weightx = 0;
        panel.add(new JLabel("Certificate:"), gbc);
        gbc.gridx = 2; gbc.weightx = 1; gbc.gridwidth = 2;
        certPathField = new JTextField();
        certPathField.setPreferredSize(new Dimension(200, 25));
        panel.add(certPathField, gbc);
        
        gbc.gridx = 4; gbc.weightx = 0; gbc.gridwidth = 1;
        browseCertButton = new JButton("Browse");
        browseCertButton.addActionListener(e -> browseCertificate());
        panel.add(browseCertButton, gbc);
        
        gbc.gridx = 5;
        connectButton = new JButton("Connect Securely");
        connectButton.addActionListener(new ConnectAction());
        panel.add(connectButton, gbc);
        
        // Row 3: Disconnect button
        gbc.gridx = 5; gbc.gridy = 2;
        disconnectButton = new JButton("Disconnect");
        disconnectButton.addActionListener(new DisconnectAction());
        disconnectButton.setEnabled(false);
        panel.add(disconnectButton, gbc);
        
        return panel;
    }
    
    /**
     * T·∫°o file tree panel ƒë·ªÉ browse remote directory:
     * - JTree hi·ªÉn th·ªã files/folders t·ª´ FTP server
     * - Upload/Download buttons cho file operations
     * 
     * @return JPanel ch·ª©a file tree v√† operation buttons
     */
    private JPanel createTreePanel() {
        JPanel panel = new JPanel(new BorderLayout());
        panel.setBorder(BorderFactory.createTitledBorder("Remote Files"));
        
        DefaultMutableTreeNode root = new DefaultMutableTreeNode("Not Connected");
        treeModel = new DefaultTreeModel(root);
        fileTree = new JTree(treeModel);
        
        JScrollPane scrollPane = new JScrollPane(fileTree);
        panel.add(scrollPane, BorderLayout.CENTER);
        
        // File operation buttons
        JPanel buttonPanel = new JPanel(new FlowLayout());
        uploadButton = new JButton("Upload");
        uploadButton.addActionListener(new UploadAction());
        uploadButton.setEnabled(false);
        
        downloadButton = new JButton("Download");
        downloadButton.addActionListener(new DownloadAction());
        downloadButton.setEnabled(false);
        
        buttonPanel.add(uploadButton);
        buttonPanel.add(downloadButton);
        panel.add(buttonPanel, BorderLayout.SOUTH);
        
        return panel;
    }
    
    /**
     * T·∫°o log panel ƒë·ªÉ monitor FTP commands:
     * - Hi·ªÉn th·ªã real-time FTP protocol commands
     * - TLS handshake process (AUTH TLS, PBSZ, PROT)
     * - File transfer status v√† error messages
     * 
     * @return JPanel ch·ª©a scrollable log area
     */
    private JPanel createLogPanel() {
        JPanel panel = new JPanel(new BorderLayout());
        panel.setBorder(BorderFactory.createTitledBorder("FTP Command Log"));
        
        logArea = new JTextArea();
        logArea.setEditable(false);
        logArea.setFont(new Font(Font.MONOSPACED, Font.PLAIN, 12));
        
        JScrollPane scrollPane = new JScrollPane(logArea);
        panel.add(scrollPane, BorderLayout.CENTER);
        
        return panel;
    }
    
    /**
     * T·∫°o status panel v·ªõi security indicators:
     * - üîí Green: "SECURE CONNECTION - Encrypted (TLS 1.2)"
     * - ‚ö†Ô∏è Red: "INSECURE CONNECTION - Plain FTP (NOT ENCRYPTED)"
     * 
     * @return JPanel ch·ª©a status label
     */
    private JPanel createStatusPanel() {
        JPanel panel = new JPanel(new FlowLayout(FlowLayout.LEFT));
        statusLabel = new JLabel("Disconnected");
        statusLabel.setFont(new Font(Font.SANS_SERIF, Font.BOLD, 12));
        panel.add(statusLabel);
        return panel;
    }
    
    /**
     * Th√™m message v√†o log area v·ªõi thread-safe update
     * T·ª± ƒë·ªông scroll xu·ªëng message m·ªõi nh·∫•t
     * 
     * @param message Log message ƒë·ªÉ hi·ªÉn th·ªã
     */
    private void appendLog(String message) {
        SwingUtilities.invokeLater(() -> {
            logArea.append(message + "\n");
            logArea.setCaretPosition(logArea.getDocument().getLength());
        });
    }
    
    /**
     * M·ªü file chooser ƒë·ªÉ ch·ªçn SSL certificate file
     * H·ªó tr·ª£ c√°c format: .pem, .crt, .cer
     * Certificate d√πng ƒë·ªÉ validate server identity
     */
    private void browseCertificate() {
        JFileChooser fileChooser = new JFileChooser();
        fileChooser.setFileFilter(new javax.swing.filechooser.FileFilter() {
            @Override
            public boolean accept(File f) {
                return f.isDirectory() || f.getName().toLowerCase().endsWith(".pem") 
                    || f.getName().toLowerCase().endsWith(".crt")
                    || f.getName().toLowerCase().endsWith(".cer");
            }
            
            @Override
            public String getDescription() {
                return "Certificate files (*.pem, *.crt, *.cer)";
            }
        });
        
        if (fileChooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
            certPathField.setText(fileChooser.getSelectedFile().getAbsolutePath());
        }
    }
    
    /**
     * üîó Connection Action Handler
     * 
     * X·ª≠ l√Ω k·∫øt n·ªëi FTP/FTPS v·ªõi security demo:
     * 
     * PLAIN FTP MODE (TLS unchecked):
     * ‚Ä¢ T·∫°o FTPClient() - no encryption
     * ‚Ä¢ Status: ‚ö†Ô∏è Red "INSECURE CONNECTION"
     * ‚Ä¢ All data transmitted in plain text
     * 
     * FTPS MODE (TLS checked):
     * ‚Ä¢ T·∫°o FTPSClient() - with TLS encryption
     * ‚Ä¢ AUTH TLS: Initiate secure handshake
     * ‚Ä¢ PBSZ 0: Setup secure data channel
     * ‚Ä¢ PROT P: Enable data encryption
     * ‚Ä¢ Status: üîí Green "SECURE CONNECTION"
     * 
     * CERTIFICATE VALIDATION:
     * ‚Ä¢ No cert: Default trust manager (accept all)
     * ‚Ä¢ Custom cert: Validate server identity
     */
    private class ConnectAction implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent e) {
            String host = hostField.getText().trim();
            String username = usernameField.getText().trim();
            String password = new String(passwordField.getPassword());
            
            if (host.isEmpty()) {
                JOptionPane.showMessageDialog(FTPSFileManager.this, "Please enter host");
                return;
            }
            
            new Thread(() -> {
                try {
                    appendLog("Connecting to " + host + "...");
                    
                    if (tlsCheckBox.isSelected()) {
                        ftpClient = new FTPSClient();
                        
                        // Configure trust manager with certificate if provided
                        String certPath = certPathField.getText().trim();
                        if (!certPath.isEmpty()) {
                            try {
                                TrustManager[] trustManagers = CertificateManager.createTrustManager(certPath);
                                ((FTPSClient)ftpClient).setTrustManager(trustManagers[0]);
                                appendLog("Using custom certificate: " + new File(certPath).getName());
                            } catch (Exception ex) {
                                appendLog("Certificate error: " + ex.getMessage());
                            }
                        }
                        
                        appendLog("üîí AUTH TLS - Initiating secure handshake...");
                    } else {
                        ftpClient = new FTPClient();
                        appendLog("‚ö†Ô∏è Plain FTP connection - NO ENCRYPTION (INSECURE)");
                    }
                    
                    // Get port from user input
                    int port;
                    try {
                        port = Integer.parseInt(portField.getText().trim());
                    } catch (NumberFormatException ex) {
                        SwingUtilities.invokeLater(() -> 
                            JOptionPane.showMessageDialog(FTPSFileManager.this, "Invalid port number"));
                        return;
                    }
                    
                    ftpClient.connect(host, port);
                    appendLog("Connecting to " + host + ":" + port + " (" + (tlsCheckBox.isSelected() ? "FTPS" : "Plain FTP") + ")");
                    
                    int reply = ftpClient.getReplyCode();
                    if (!FTPReply.isPositiveCompletion(reply)) {
                        ftpClient.disconnect();
                        appendLog("Connection failed: " + ftpClient.getReplyString());
                        return;
                    }
                    
                    appendLog("Connected: " + ftpClient.getReplyString().trim());
                    
                    if (ftpClient.login(username, password)) {
                        appendLog("Login successful");
                        
                        // Set passive mode for better compatibility
                        ftpClient.enterLocalPassiveMode();
                        appendLog("PASV - Entering passive mode");
                        
                        if (tlsCheckBox.isSelected()) {
                            ((FTPSClient)ftpClient).execPBSZ(0);
                            appendLog("üîí PBSZ 0 - Setting up secure data channel...");
                            ((FTPSClient)ftpClient).execPROT("P");
                            appendLog("üîí PROT P - Data channel encryption ENABLED");
                            
                            String certInfo = certPathField.getText().trim().isEmpty() ? 
                                "(Default Trust)" : "(Custom Certificate)";
                            
                            SwingUtilities.invokeLater(() -> {
                                statusLabel.setText("üîí SECURE CONNECTION - Encrypted (TLS 1.2) " + certInfo);
                                statusLabel.setForeground(new Color(0, 128, 0)); // Green
                            });
                        } else {
                            SwingUtilities.invokeLater(() -> {
                                statusLabel.setText("‚ö†Ô∏è INSECURE CONNECTION - Plain FTP (NOT ENCRYPTED)");
                                statusLabel.setForeground(new Color(255, 0, 0)); // Red
                            });
                        }
                        
                        SwingUtilities.invokeLater(() -> {
                            connectButton.setEnabled(false);
                            disconnectButton.setEnabled(true);
                            uploadButton.setEnabled(true);
                            downloadButton.setEnabled(true);
                        });
                        
                        loadFileTree();
                    } else {
                        appendLog("Login failed");
                        ftpClient.disconnect();
                    }
                    
                } catch (Exception ex) {
                    appendLog("Error: " + ex.getMessage());
                }
            }).start();
        }
    }
    
    /**
     * üîå Disconnect Action Handler
     * 
     * Safely disconnect t·ª´ FTP server:
     * ‚Ä¢ Send QUIT command
     * ‚Ä¢ Close socket connection
     * ‚Ä¢ Reset GUI state
     * ‚Ä¢ Clear security status
     */
    private class DisconnectAction implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent e) {
            new Thread(() -> {
                try {
                    if (ftpClient.isConnected()) {
                        ftpClient.logout();
                        ftpClient.disconnect();
                        appendLog("Disconnected");
                    }
                } catch (Exception ex) {
                    appendLog("Disconnect error: " + ex.getMessage());
                }
                
                SwingUtilities.invokeLater(() -> {
                    connectButton.setEnabled(true);
                    disconnectButton.setEnabled(false);
                    uploadButton.setEnabled(false);
                    downloadButton.setEnabled(false);
                    statusLabel.setText("Disconnected");
                    statusLabel.setForeground(Color.BLACK);
                    
                    DefaultMutableTreeNode root = new DefaultMutableTreeNode("Not Connected");
                    treeModel.setRoot(root);
                });
            }).start();
        }
    }
    
    /**
     * üìÅ Load Remote Directory Tree
     * 
     * Retrieve file list t·ª´ FTP server:
     * ‚Ä¢ Try LIST command first (detailed info)
     * ‚Ä¢ Fallback to NLST (names only) n·∫øu LIST fails
     * ‚Ä¢ Update JTree v·ªõi files/directories
     * ‚Ä¢ Directories hi·ªÉn th·ªã v·ªõi "/" suffix
     */
    private void loadFileTree() {
        new Thread(() -> {
            try {
                // Try different approaches for listing files
                FTPFile[] files = null;
                
                try {
                    files = ftpClient.listFiles();
                } catch (Exception e1) {
                    appendLog("LIST failed, trying NLST: " + e1.getMessage());
                    try {
                        String[] fileNames = ftpClient.listNames();
                        if (fileNames != null) {
                            files = new FTPFile[fileNames.length];
                            for (int i = 0; i < fileNames.length; i++) {
                                files[i] = new FTPFile();
                                files[i].setName(fileNames[i]);
                            }
                        }
                    } catch (Exception e2) {
                        appendLog("NLST also failed: " + e2.getMessage());
                    }
                }
                
                if (files == null) files = new FTPFile[0];
                
                final FTPFile[] finalFiles = files;
                appendLog("LIST - Retrieved " + finalFiles.length + " files");
                
                SwingUtilities.invokeLater(() -> {
                    DefaultMutableTreeNode root = new DefaultMutableTreeNode("Root Directory");
                    
                    Arrays.stream(finalFiles)
                        .forEach(file -> {
                            String name = file.getName();
                            if (file.isDirectory()) {
                                name += "/";
                            }
                            root.add(new DefaultMutableTreeNode(name));
                        });
                    
                    treeModel.setRoot(root);
                    fileTree.expandRow(0);
                });
                
            } catch (Exception ex) {
                appendLog("Error loading files: " + ex.getMessage());
            }
        }).start();
    }
    
    /**
     * ‚¨ÜÔ∏è Upload Action Handler
     * 
     * Upload file l√™n FTP server:
     * ‚Ä¢ M·ªü file chooser ƒë·ªÉ ch·ªçn local file
     * ‚Ä¢ Use STOR command ƒë·ªÉ transfer
     * ‚Ä¢ Monitor upload progress trong log
     * ‚Ä¢ Refresh file tree sau khi complete
     * 
     * SECURITY NOTE:
     * ‚Ä¢ Plain FTP: File content transmitted unencrypted
     * ‚Ä¢ FTPS: File content encrypted v·ªõi TLS
     */
    private class UploadAction implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent e) {
            JFileChooser fileChooser = new JFileChooser();
            if (fileChooser.showOpenDialog(FTPSFileManager.this) == JFileChooser.APPROVE_OPTION) {
                File selectedFile = fileChooser.getSelectedFile();
                
                new Thread(() -> {
                    try (FileInputStream fis = new FileInputStream(selectedFile)) {
                        appendLog("STOR " + selectedFile.getName() + " - Uploading...");
                        
                        boolean success = ftpClient.storeFile(selectedFile.getName(), fis);
                        if (success) {
                            appendLog("Upload completed: " + selectedFile.getName());
                            loadFileTree();
                        } else {
                            appendLog("Upload failed: " + ftpClient.getReplyString());
                        }
                        
                    } catch (Exception ex) {
                        appendLog("Upload error: " + ex.getMessage());
                    }
                }).start();
            }
        }
    }
    
    /**
     * ‚¨áÔ∏è Download Action Handler
     * 
     * Download file t·ª´ FTP server:
     * ‚Ä¢ Get selected file t·ª´ tree
     * ‚Ä¢ M·ªü save dialog ƒë·ªÉ ch·ªçn local path
     * ‚Ä¢ Use RETR command ƒë·ªÉ transfer
     * ‚Ä¢ Monitor download progress trong log
     * 
     * SECURITY NOTE:
     * ‚Ä¢ Plain FTP: File content transmitted unencrypted
     * ‚Ä¢ FTPS: File content encrypted v·ªõi TLS
     */
    private class DownloadAction implements ActionListener {
        @Override
        public void actionPerformed(ActionEvent e) {
            DefaultMutableTreeNode selectedNode = 
                (DefaultMutableTreeNode) fileTree.getLastSelectedPathComponent();
            
            if (selectedNode == null || selectedNode.isRoot()) {
                JOptionPane.showMessageDialog(FTPSFileManager.this, "Please select a file");
                return;
            }
            
            String fileName = selectedNode.toString();
            if (fileName.endsWith("/")) {
                JOptionPane.showMessageDialog(FTPSFileManager.this, "Cannot download directory");
                return;
            }
            
            JFileChooser fileChooser = new JFileChooser();
            fileChooser.setSelectedFile(new File(fileName));
            
            if (fileChooser.showSaveDialog(FTPSFileManager.this) == JFileChooser.APPROVE_OPTION) {
                File saveFile = fileChooser.getSelectedFile();
                
                new Thread(() -> {
                    try (FileOutputStream fos = new FileOutputStream(saveFile)) {
                        appendLog("RETR " + fileName + " - Downloading...");
                        
                        boolean success = ftpClient.retrieveFile(fileName, fos);
                        if (success) {
                            appendLog("Download completed: " + fileName);
                        } else {
                            appendLog("Download failed: " + ftpClient.getReplyString());
                        }
                        
                    } catch (Exception ex) {
                        appendLog("Download error: " + ex.getMessage());
                    }
                }).start();
            }
        }
    }
    
    /**
     * Main method - kh·ªüi ƒë·ªông FTPS File Manager application
     * 
     * S·ª≠ d·ª•ng SwingUtilities.invokeLater ƒë·ªÉ ensure GUI t·∫°o tr√™n EDT
     * 
     * DEMO WORKFLOW:
     * 1. Start demo server (ftp_server.py ho·∫∑c ftps_server.py)
     * 2. Run application n√†y
     * 3. Toggle TLS checkbox ƒë·ªÉ compare security
     * 4. Monitor log ƒë·ªÉ see FTP commands v√† TLS handshake
     * 
     * @param args Command line arguments (kh√¥ng s·ª≠ d·ª•ng)
     */
    public static void main(String[] args) {
        SwingUtilities.invokeLater(() -> {
            new FTPSFileManager().setVisible(true);
        });
    }
}